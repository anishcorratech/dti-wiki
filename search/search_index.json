{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"DTI Wiki \u2693\ufe0e This is the DTI Wiki page dealing with Open Source Softwares used in GNU/Linux Administration and Devops Automation.","title":"DTI Wiki"},{"location":"#dti-wiki","text":"This is the DTI Wiki page dealing with Open Source Softwares used in GNU/Linux Administration and Devops Automation.","title":"DTI Wiki"},{"location":"about/","text":"Devops Technical Institute - Library \u2693\ufe0e DTI Wiki is an effort to document GNU/Linux Devops process and workflows.","title":"About"},{"location":"about/#devops-technical-institute-library","text":"DTI Wiki is an effort to document GNU/Linux Devops process and workflows.","title":"Devops Technical Institute - Library"},{"location":"containers/","text":"Containers \u2693\ufe0e Container orchestration, Docker Kubernetes Kustomize Ambassador Edge Stack","title":"Index"},{"location":"containers/#containers","text":"Container orchestration, Docker Kubernetes Kustomize Ambassador Edge Stack","title":"Containers"},{"location":"psy-mcloud/","text":"Psychedelic Magento Cloud \u2693\ufe0e Adobe Commerce Cloud formerly known as Magento Cloud is a Platform as a Service (PaaS) environment for magento 2x family of ecommerce framework. The PaaS is hosted by Adobe on Platform.sh. Customers are given access to the hosted server via restricted SSH acecss. There is only a common SSH user for all user account's created under magento-cloud. The SSH user do not have a dedicated $HOME directory. The \"Psychedelic MCloud\" is a group of custom scripts created to create an overlay over these restrctions and give bash history and other integrations. Source \u2693\ufe0e The Psychedelic Magento Cloud can be found at: Psychedelic Magento Cloud Source Details \u2693\ufe0e Psychedelic MCloud contains customizations for: bash history tmux integration mysql backups ngrok integration (partial) Bash \u2693\ufe0e The bash customization is for enabling bash history, when invoked from the terminal multiplexer (tmux). tmux \u2693\ufe0e The tux customization contains the basic tmux.conf file and a custom shell to enable bash overrides. The tmux.conf try to use a custom shell from the file shell from the above bash bash customization. The tmux.conf also have support for mouse support for various versions of tmux found in new-generation and old-generation cloud servers. Initiate tmux \u2693\ufe0e tmux - f var / corra / tmux / tmux . conf new - s corra_devops_01 MySQL Scripts \u2693\ufe0e There are two mysql customizations in this directory. The myconnect is used to connect to mysql by directly reading app/etc/env.php . Also mydbdump is a mysql backup script. ngrok \u2693\ufe0e This is used for media sync using ngrok","title":"Psychedelic Magento Cloud"},{"location":"psy-mcloud/#psychedelic-magento-cloud","text":"Adobe Commerce Cloud formerly known as Magento Cloud is a Platform as a Service (PaaS) environment for magento 2x family of ecommerce framework. The PaaS is hosted by Adobe on Platform.sh. Customers are given access to the hosted server via restricted SSH acecss. There is only a common SSH user for all user account's created under magento-cloud. The SSH user do not have a dedicated $HOME directory. The \"Psychedelic MCloud\" is a group of custom scripts created to create an overlay over these restrctions and give bash history and other integrations.","title":"Psychedelic Magento Cloud"},{"location":"psy-mcloud/#source","text":"The Psychedelic Magento Cloud can be found at: Psychedelic Magento Cloud Source","title":"Source"},{"location":"psy-mcloud/#details","text":"Psychedelic MCloud contains customizations for: bash history tmux integration mysql backups ngrok integration (partial)","title":"Details"},{"location":"psy-mcloud/#bash","text":"The bash customization is for enabling bash history, when invoked from the terminal multiplexer (tmux).","title":"Bash"},{"location":"psy-mcloud/#tmux","text":"The tux customization contains the basic tmux.conf file and a custom shell to enable bash overrides. The tmux.conf try to use a custom shell from the file shell from the above bash bash customization. The tmux.conf also have support for mouse support for various versions of tmux found in new-generation and old-generation cloud servers.","title":"tmux"},{"location":"psy-mcloud/#mysql-scripts","text":"There are two mysql customizations in this directory. The myconnect is used to connect to mysql by directly reading app/etc/env.php . Also mydbdump is a mysql backup script.","title":"MySQL Scripts"},{"location":"psy-mcloud/#ngrok","text":"This is used for media sync using ngrok","title":"ngrok"},{"location":"containers/docker/","text":"Docker \u2693\ufe0e These are the wiki pages created under Docker Contents \u2693\ufe0e Container Init Script","title":"Index"},{"location":"containers/docker/#docker","text":"These are the wiki pages created under Docker","title":"Docker"},{"location":"containers/docker/#contents","text":"Container Init Script","title":"Contents"},{"location":"containers/docker/caddy-container/","text":"Caddy Container \u2693\ufe0e Using a Caddy Server as a reverse proxy to route traffic to adminer. Caddyfile \u2693\ufe0e Below is the Caddyfile v2 your - name . domain . com encode gzip reverse_proxy / sql adminer : 8080 tls your - email @domain . com Docker Compose \u2693\ufe0e Below is the docker-compose.yml file for Caddy Server. version : \"3.2\" services : sql1 : container_name : sql1 image : mcr . microsoft . com / mssql / server : 2022 - latest tty : true ports : - \"135:135\" - \"1431:1431\" - \"1433:1433\" - \"1434:1434\" restart : always environment : MSSQL_SA_PASSWORD : fake1234567890xyz SA_PASSWORD : fake1234567890xyz ACCEPT_EULA : \"Y\" volumes : - / home / user / service / dumps : / dumps - / home / user / service / db / data : / var / opt / mssql / data caddy : image : caddy : 2.6 . 2 - alpine container_name : caddy restart : always ports : - \"80:80\" - \"443:443\" - \"443:443/udp\" volumes : - / home / user / service / caddy / Caddyfile : / etc / caddy / Caddyfile adminer : container_name : adminer image : adminer : latest ports : - \"8080:8080\" links : - sql1 depends_on : - sql1 restart : always","title":"Index"},{"location":"containers/docker/caddy-container/#caddy-container","text":"Using a Caddy Server as a reverse proxy to route traffic to adminer.","title":"Caddy Container"},{"location":"containers/docker/caddy-container/#caddyfile","text":"Below is the Caddyfile v2 your - name . domain . com encode gzip reverse_proxy / sql adminer : 8080 tls your - email @domain . com","title":"Caddyfile"},{"location":"containers/docker/caddy-container/#docker-compose","text":"Below is the docker-compose.yml file for Caddy Server. version : \"3.2\" services : sql1 : container_name : sql1 image : mcr . microsoft . com / mssql / server : 2022 - latest tty : true ports : - \"135:135\" - \"1431:1431\" - \"1433:1433\" - \"1434:1434\" restart : always environment : MSSQL_SA_PASSWORD : fake1234567890xyz SA_PASSWORD : fake1234567890xyz ACCEPT_EULA : \"Y\" volumes : - / home / user / service / dumps : / dumps - / home / user / service / db / data : / var / opt / mssql / data caddy : image : caddy : 2.6 . 2 - alpine container_name : caddy restart : always ports : - \"80:80\" - \"443:443\" - \"443:443/udp\" volumes : - / home / user / service / caddy / Caddyfile : / etc / caddy / Caddyfile adminer : container_name : adminer image : adminer : latest ports : - \"8080:8080\" links : - sql1 depends_on : - sql1 restart : always","title":"Docker Compose"},{"location":"containers/docker/container-init/","text":"Container Init \u2693\ufe0e At times, we think if only this container acted a little different that its normal. say for example: we need to change the default user defined in dockerfile but at the same time we don't want to rebuild the dockerimage. install new packages in a docker image, yet we don't want to build a new image using the source of the original docker image. sometimes when you are lazy and you want to directly manipulate a docker image The Script \u2693\ufe0e Then you may need \"con-init\" or coninit.sh a.k.a \"Container Init\" This is a coninit.sh for alpine linux based containers. #!/bin/bash UID = 1000 GID = 1000 USERNAME = anish #install dependencies apk update apk add shadow sudo bash curl yarn jq #Create User and Groups and Sudo Access groupadd -g ${ GID } ${ USERNAME } useradd ${ USERNAME } -u ${ UID } -g ${ GID } -m -s /bin/bash usermod -a -G wheel ${ USERNAME } echo \" ${ USERNAME } ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers.d/ ${ USERNAME } #Run infinitely tail -f /dev/null The Compose file \u2693\ufe0e Now to use this coninit.sh we wil employ a docker-compose.yml file as below: version: '3.8' services: node-dev: image: node:16.16.0-slim container_name: node-dev working_dir: /srv environment: - VAR1=\"Foo\" - VAR2=\"Bar\" volumes: - ./con-init.sh:/root/con-init.sh - ./app:/srv command: sh /root/con-init.sh Create a empty directory named \"app\" in the same directory which houses docker-compose.yml file. you can put the code files in the newly created \"app\" directory. Then do: docker-compose up -d now a new container named node-dev with start using the node:16.16.0-slim image with the changes we added in the coninit.sh file. Now lets connect to the new container, assuming we created the user as anish in the coninit.sh file. If you used a different user replace anish with the username you used in the below command. docker - compose exec - u anish - it node - dev / bin / bash","title":"Index"},{"location":"containers/docker/container-init/#container-init","text":"At times, we think if only this container acted a little different that its normal. say for example: we need to change the default user defined in dockerfile but at the same time we don't want to rebuild the dockerimage. install new packages in a docker image, yet we don't want to build a new image using the source of the original docker image. sometimes when you are lazy and you want to directly manipulate a docker image","title":"Container Init"},{"location":"containers/docker/container-init/#the-script","text":"Then you may need \"con-init\" or coninit.sh a.k.a \"Container Init\" This is a coninit.sh for alpine linux based containers. #!/bin/bash UID = 1000 GID = 1000 USERNAME = anish #install dependencies apk update apk add shadow sudo bash curl yarn jq #Create User and Groups and Sudo Access groupadd -g ${ GID } ${ USERNAME } useradd ${ USERNAME } -u ${ UID } -g ${ GID } -m -s /bin/bash usermod -a -G wheel ${ USERNAME } echo \" ${ USERNAME } ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers.d/ ${ USERNAME } #Run infinitely tail -f /dev/null","title":"The Script"},{"location":"containers/docker/container-init/#the-compose-file","text":"Now to use this coninit.sh we wil employ a docker-compose.yml file as below: version: '3.8' services: node-dev: image: node:16.16.0-slim container_name: node-dev working_dir: /srv environment: - VAR1=\"Foo\" - VAR2=\"Bar\" volumes: - ./con-init.sh:/root/con-init.sh - ./app:/srv command: sh /root/con-init.sh Create a empty directory named \"app\" in the same directory which houses docker-compose.yml file. you can put the code files in the newly created \"app\" directory. Then do: docker-compose up -d now a new container named node-dev with start using the node:16.16.0-slim image with the changes we added in the coninit.sh file. Now lets connect to the new container, assuming we created the user as anish in the coninit.sh file. If you used a different user replace anish with the username you used in the below command. docker - compose exec - u anish - it node - dev / bin / bash","title":"The Compose file"},{"location":"containers/kubernetes/kubectl/cheatsheets/kubectl-basic-part-1/","text":"Kubectl Basic Cheatsheet - Part Uno \u2693\ufe0e Kubectl is like the swiss army knife when dealing with kubernetes cluster. These are some basic hacks, which will be useful to someone. Dealing with jsonpath \u2693\ufe0e JSONPath template is composed of JSONPath expressions enclosed by {}. We can use JSONPath expressions to filter on specific fields from kubectl outputs. Good Reads \u2693\ufe0e https://downey.io/notes/dev/kubectl-jsonpath-new-lines/ https://gist.github.com/so0k/42313dbb3b547a0f51a547bb968696ba https://kubernetes.io/docs/reference/kubectl/jsonpath/ https://unofficial-kubernetes.readthedocs.io/en/latest/user-guide/jsonpath/ Printing the names of kubernetes deployments \u2693\ufe0e kubectl get - n kube - system deploy - o jsonpath = ' {range .items[*]}{.metadata.name}{\" \\n \"}{end} ' See the sample output $ kubectl get -n newrelic deploy -o jsonpath = '{range .items[*]}{.metadata.name}{\"\\n\"}{end}' kelvin nri-bundle-kube-state-metrics nri-bundle-nri-kube-events nri-bundle-nri-metadata-injection nri-bundle-nrk8s-ksm vizier-cloud-connector vizier-query-broker Printing the IP Addresses of the all pods in newrelic namespace \u2693\ufe0e kubectl get pods - n newrelic - o jsonpath = ' {range .items[*]}{.status.podIP}{\" \\n \"}{end} ' See the sample output $ kubectl get pods -n newrelic -o jsonpath = '{range .items[*]}{.status.podIP}{\"\\n\"}{end}' 172 .16.0.179 172 .16.1.17 172 .16.1.198 172 .16.1.61 172 .16.0.183 172 .16.0.187 172 .16.1.132 172 .16.1.178 172 .16.1.11 172 .16.0.178 172 .16.1.167 172 .16.1.214 172 .16.1.161 172 .16.0.81 172 .16.1.209 172 .16.1.61 172 .16.0.183 172 .16.1.198 172 .16.1.102 You can use two fields and format it to your liking using whitespace as well. kubectl get pods - n newrelic - o jsonpath = ' {range .items[*]}{.metadata.namespace}{\"/\"}{.metadata.name}{\",\"}{.status.podIP}{\" \\n \"}{end} ' See the sample output $ kubectl get pods -n newrelic -o jsonpath = '{range .items[*]}{.metadata.namespace}{\"/\"}{.metadata.name}{\",\"}{.status.podIP}{\"\\n\"}{end}' newrelic/kelvin-54b954889c-4zsz5,172.16.0.179 newrelic/nri-bundle-kube-state-metrics-778f8d7756-6tgzg,172.16.1.17 newrelic/nri-bundle-newrelic-logging-9bctl,172.16.1.198 newrelic/nri-bundle-newrelic-logging-splhw,172.16.1.61 newrelic/nri-bundle-newrelic-logging-tfl7r,172.16.0.183 newrelic/nri-bundle-newrelic-prometheus-agent-0,172.16.0.187 newrelic/nri-bundle-nri-kube-events-695cc855d4-jtdtk,172.16.1.132 newrelic/nri-bundle-nri-metadata-injection-7bfddbc55d-khxrt,172.16.1.178 newrelic/nri-bundle-nrk8s-ksm-9bf8fbf54-fpp29,172.16.1.11 newrelic/nri-bundle-nrk8s-kubelet-22plc,172.16.0.178 newrelic/nri-bundle-nrk8s-kubelet-qzhhs,172.16.1.167 newrelic/nri-bundle-nrk8s-kubelet-vpmbq,172.16.1.214 newrelic/pl-nats-0,172.16.1.161 newrelic/vizier-cloud-connector-5d454b78f6-wq2v8,172.16.0.81 newrelic/vizier-metadata-0,172.16.1.209 newrelic/vizier-pem-6ctzn,172.16.1.61 newrelic/vizier-pem-vgbq5,172.16.0.183 newrelic/vizier-pem-wfbwk,172.16.1.198 newrelic/vizier-query-broker-7f57fbfc6d-5qckt,172.16.1.102","title":"Kubectl Basic Cheatsheet - Part Uno"},{"location":"containers/kubernetes/kubectl/cheatsheets/kubectl-basic-part-1/#kubectl-basic-cheatsheet-part-uno","text":"Kubectl is like the swiss army knife when dealing with kubernetes cluster. These are some basic hacks, which will be useful to someone.","title":"Kubectl Basic Cheatsheet - Part Uno"},{"location":"containers/kubernetes/kubectl/cheatsheets/kubectl-basic-part-1/#dealing-with-jsonpath","text":"JSONPath template is composed of JSONPath expressions enclosed by {}. We can use JSONPath expressions to filter on specific fields from kubectl outputs.","title":"Dealing with jsonpath"},{"location":"containers/kubernetes/kubectl/cheatsheets/kubectl-basic-part-1/#good-reads","text":"https://downey.io/notes/dev/kubectl-jsonpath-new-lines/ https://gist.github.com/so0k/42313dbb3b547a0f51a547bb968696ba https://kubernetes.io/docs/reference/kubectl/jsonpath/ https://unofficial-kubernetes.readthedocs.io/en/latest/user-guide/jsonpath/","title":"Good Reads"},{"location":"containers/kubernetes/kubectl/cheatsheets/kubectl-basic-part-1/#printing-the-names-of-kubernetes-deployments","text":"kubectl get - n kube - system deploy - o jsonpath = ' {range .items[*]}{.metadata.name}{\" \\n \"}{end} ' See the sample output $ kubectl get -n newrelic deploy -o jsonpath = '{range .items[*]}{.metadata.name}{\"\\n\"}{end}' kelvin nri-bundle-kube-state-metrics nri-bundle-nri-kube-events nri-bundle-nri-metadata-injection nri-bundle-nrk8s-ksm vizier-cloud-connector vizier-query-broker","title":"Printing the names of kubernetes deployments"},{"location":"containers/kubernetes/kubectl/cheatsheets/kubectl-basic-part-1/#printing-the-ip-addresses-of-the-all-pods-in-newrelic-namespace","text":"kubectl get pods - n newrelic - o jsonpath = ' {range .items[*]}{.status.podIP}{\" \\n \"}{end} ' See the sample output $ kubectl get pods -n newrelic -o jsonpath = '{range .items[*]}{.status.podIP}{\"\\n\"}{end}' 172 .16.0.179 172 .16.1.17 172 .16.1.198 172 .16.1.61 172 .16.0.183 172 .16.0.187 172 .16.1.132 172 .16.1.178 172 .16.1.11 172 .16.0.178 172 .16.1.167 172 .16.1.214 172 .16.1.161 172 .16.0.81 172 .16.1.209 172 .16.1.61 172 .16.0.183 172 .16.1.198 172 .16.1.102 You can use two fields and format it to your liking using whitespace as well. kubectl get pods - n newrelic - o jsonpath = ' {range .items[*]}{.metadata.namespace}{\"/\"}{.metadata.name}{\",\"}{.status.podIP}{\" \\n \"}{end} ' See the sample output $ kubectl get pods -n newrelic -o jsonpath = '{range .items[*]}{.metadata.namespace}{\"/\"}{.metadata.name}{\",\"}{.status.podIP}{\"\\n\"}{end}' newrelic/kelvin-54b954889c-4zsz5,172.16.0.179 newrelic/nri-bundle-kube-state-metrics-778f8d7756-6tgzg,172.16.1.17 newrelic/nri-bundle-newrelic-logging-9bctl,172.16.1.198 newrelic/nri-bundle-newrelic-logging-splhw,172.16.1.61 newrelic/nri-bundle-newrelic-logging-tfl7r,172.16.0.183 newrelic/nri-bundle-newrelic-prometheus-agent-0,172.16.0.187 newrelic/nri-bundle-nri-kube-events-695cc855d4-jtdtk,172.16.1.132 newrelic/nri-bundle-nri-metadata-injection-7bfddbc55d-khxrt,172.16.1.178 newrelic/nri-bundle-nrk8s-ksm-9bf8fbf54-fpp29,172.16.1.11 newrelic/nri-bundle-nrk8s-kubelet-22plc,172.16.0.178 newrelic/nri-bundle-nrk8s-kubelet-qzhhs,172.16.1.167 newrelic/nri-bundle-nrk8s-kubelet-vpmbq,172.16.1.214 newrelic/pl-nats-0,172.16.1.161 newrelic/vizier-cloud-connector-5d454b78f6-wq2v8,172.16.0.81 newrelic/vizier-metadata-0,172.16.1.209 newrelic/vizier-pem-6ctzn,172.16.1.61 newrelic/vizier-pem-vgbq5,172.16.0.183 newrelic/vizier-pem-wfbwk,172.16.1.198 newrelic/vizier-query-broker-7f57fbfc6d-5qckt,172.16.1.102","title":"Printing the IP Addresses of the all pods in newrelic namespace"},{"location":"snippets/cloud-cron-disable/","text":"Disable Cron on Magento Enterprise Cloud \u2693\ufe0e Usually crons are by default enabled in the magento configuration. If you have to disable the magento cloud crons. Please modify app/etc/env.php and add 'enabled' => 0, under \"cron\" array as below. 'cron' => array ( 'enabled' => 0, ), If the env.php is square-brackets then use below format: 'cron' => [ 'enabled' => 0 ] Monitor the cron logs : tail - f $ HOME / var / log / cron . log","title":"Cloud Cron Disable"},{"location":"snippets/cloud-cron-disable/#disable-cron-on-magento-enterprise-cloud","text":"Usually crons are by default enabled in the magento configuration. If you have to disable the magento cloud crons. Please modify app/etc/env.php and add 'enabled' => 0, under \"cron\" array as below. 'cron' => array ( 'enabled' => 0, ), If the env.php is square-brackets then use below format: 'cron' => [ 'enabled' => 0 ] Monitor the cron logs : tail - f $ HOME / var / log / cron . log","title":"Disable Cron on Magento Enterprise Cloud"},{"location":"snippets/cloud-db-auth/","text":"Magento 2x Cloud DB Authentication \u2693\ufe0e Set Time \u2693\ufe0e BKPTIM=$(date +\"%Y-%m-%d_%H-%M-%S\") Ticket Number \u2693\ufe0e Optionally set ticket number if required. TKT=\"JIRA-123\" Set Authentication variables: \u2693\ufe0e export DB_NAME =$ ( grep [ \\ ']db[ \\' ] -A 20 app/etc/env.php | grep dbname | head -n1 | sed \"s/.*[=][>][ ]*[' ] // \" | sed \" s / [ '][,]//\"); export MYSQL_HOST =$ ( grep [ \\ ']db[ \\' ] -A 20 app/etc/env.php | grep host | head -n1 | sed \"s/.*[=][>][ ]*[' ] // \" | sed \" s / [ '][,]//\"); export DB_USER =$ ( grep [ \\ ']db[ \\' ] -A 20 app/etc/env.php | grep username | head -n1 | sed \"s/.*[=][>][ ]*[' ] // \" | sed \" s / [ '][,]//\"); export MYSQL_PWD =$ ( grep [ \\ ']db[ \\' ] -A 20 app/etc/env.php | grep password | head -n1 | sed \"s/.*[=][>][ ]*[' ] // \" | sed \" s / [ ']$//\" | sed \"s/[' ][,] // \"); Connect to MySQL with above set authentication variables. \u2693\ufe0e mysql -h $MYSQL_HOST -u $DB_USER --password=$MYSQL_PWD $DB_NAME -A Database Dump \u2693\ufe0e mysqldump - h $ MYSQL_HOST - u $ DB_USER -- password =$ MYSQL_PWD $ DB_NAME -- opt -- single - transaction -- skip - lock - tables | sed - e 's/DEFINER[ ]*=[ ]*[^*]*\\*/\\*/' | gzip > var / backups /$ DB_NAME .$ { BKPTIM } . sql . gz If you want to add the ticket name to the dump as well. mysqldump - h $ MYSQL_HOST - u $ DB_USER -- password =$ MYSQL_PWD $ DB_NAME -- opt -- single - transaction -- skip - lock - tables | sed - e 's/DEFINER[ ]*=[ ]*[^*]*\\*/\\*/' | gzip > var / backups /$ TKT .$ DB_NAME .$ { BKPTIM } . sql . gz","title":"Cloud DB Authentication"},{"location":"snippets/cloud-db-auth/#magento-2x-cloud-db-authentication","text":"","title":"Magento 2x Cloud DB Authentication"},{"location":"snippets/cloud-db-auth/#set-time","text":"BKPTIM=$(date +\"%Y-%m-%d_%H-%M-%S\")","title":"Set Time"},{"location":"snippets/cloud-db-auth/#ticket-number","text":"Optionally set ticket number if required. TKT=\"JIRA-123\"","title":"Ticket Number"},{"location":"snippets/cloud-db-auth/#set-authentication-variables","text":"export DB_NAME =$ ( grep [ \\ ']db[ \\' ] -A 20 app/etc/env.php | grep dbname | head -n1 | sed \"s/.*[=][>][ ]*[' ] // \" | sed \" s / [ '][,]//\"); export MYSQL_HOST =$ ( grep [ \\ ']db[ \\' ] -A 20 app/etc/env.php | grep host | head -n1 | sed \"s/.*[=][>][ ]*[' ] // \" | sed \" s / [ '][,]//\"); export DB_USER =$ ( grep [ \\ ']db[ \\' ] -A 20 app/etc/env.php | grep username | head -n1 | sed \"s/.*[=][>][ ]*[' ] // \" | sed \" s / [ '][,]//\"); export MYSQL_PWD =$ ( grep [ \\ ']db[ \\' ] -A 20 app/etc/env.php | grep password | head -n1 | sed \"s/.*[=][>][ ]*[' ] // \" | sed \" s / [ ']$//\" | sed \"s/[' ][,] // \");","title":"Set Authentication variables:"},{"location":"snippets/cloud-db-auth/#connect-to-mysql-with-above-set-authentication-variables","text":"mysql -h $MYSQL_HOST -u $DB_USER --password=$MYSQL_PWD $DB_NAME -A","title":"Connect to MySQL with above set authentication variables."},{"location":"snippets/cloud-db-auth/#database-dump","text":"mysqldump - h $ MYSQL_HOST - u $ DB_USER -- password =$ MYSQL_PWD $ DB_NAME -- opt -- single - transaction -- skip - lock - tables | sed - e 's/DEFINER[ ]*=[ ]*[^*]*\\*/\\*/' | gzip > var / backups /$ DB_NAME .$ { BKPTIM } . sql . gz If you want to add the ticket name to the dump as well. mysqldump - h $ MYSQL_HOST - u $ DB_USER -- password =$ MYSQL_PWD $ DB_NAME -- opt -- single - transaction -- skip - lock - tables | sed - e 's/DEFINER[ ]*=[ ]*[^*]*\\*/\\*/' | gzip > var / backups /$ TKT .$ DB_NAME .$ { BKPTIM } . sql . gz","title":"Database Dump"},{"location":"snippets/cloud-elasticsearch-management/","text":"Magento Cloud Elasticsearch Management \u2693\ufe0e The elasticsearch in magento cloud maight require manual maintenanace from time to time. This document list the useful commands to manage the magento cloud elasticsearch instance using CURL http client. Why? \u2693\ufe0e There can be several potential causes. One cause is the Elasticsearch instance running out of disk space. Another cause is duplicated indices. Word of advice! \u2693\ufe0e Create a fresh mysql dump before following these steps Perform this operations outside of business hours On production environments enable maintenanace mode if possible On production environments disble the magento cron jobs till this activity is completed. Procedure \u2693\ufe0e List Indices \u2693\ufe0e List the indices on the elasticsearch instance curl -s -X GET localhost:9200/_cat/indices?v This should give something lie this: health status index uuid pri rep docs.count docs.deleted store.size pri.store.size green open magento2_stg_product_16_v3 ro_35-TIQ5KT9H4ggVOwZw 3 2 0 0 2kb 705b green open magento2_stg_product_20_v94 MPZqxSLQQweP_YwjuIeTWg 3 2 19 4 955.9kb 318.6kb green open magento2_stg_product_18_v208 X7FehtL5RROo_crbnHYCxw 3 2 19 0 504.1kb 168kb green open magento2_stg_product_17_v4 lb-6wI_PTr-9hKVWWIQYjA 3 2 0 0 2kb 693b green open magento2_stg_product_6_v109 5ibsu0JmT9uOAS98bDS3Tg 3 2 61 0 201.3kb 64.6kb green open magento2_stg_product_1_v3552 fWMK8iSzRjeub_z58sT5gg 3 2 552 11 25.8mb 8.4mb green open magento2_stg_product_15_v125 HwztB4diTH2fQRGWwKS14A 3 2 21 3 1.6mb 547.8kb green open magento2_stg_product_9_v179 paVM9hHvT32ZG9jDNipNRg 3 2 0 0 1.8kb 624b green open magento2_stg_product_14_v498 _W2lSyEsQdWChM6kMro6Xw 3 2 21 0 1.1mb 398.2kb green open magento2_stg_product_5_v1094 2QfuKR42Q8q73oIsCJmNow 3 2 447 0 16.4mb 5.2mb green open magento2_product_1_v1 3irjvym7T5ycPgeQV0pOcg 3 2 0 0 2.2kb 783b Delete Indices \u2693\ufe0e curl - XDELETE localhost : 9200 /[ your_index_name_here ] Then do a full reindexing. Source: \u2693\ufe0e https://support.magento.com/hc/en-us/articles/360039837952-Elasticsearch-Index-Status-is-yellow-or-red- https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/troubleshooting/elasticsearch/elasticsearch-index-status-is-yellow-or-red.html?lang=en","title":"Magento Cloud Elasticsearch"},{"location":"snippets/cloud-elasticsearch-management/#magento-cloud-elasticsearch-management","text":"The elasticsearch in magento cloud maight require manual maintenanace from time to time. This document list the useful commands to manage the magento cloud elasticsearch instance using CURL http client.","title":"Magento Cloud Elasticsearch Management"},{"location":"snippets/cloud-elasticsearch-management/#why","text":"There can be several potential causes. One cause is the Elasticsearch instance running out of disk space. Another cause is duplicated indices.","title":"Why?"},{"location":"snippets/cloud-elasticsearch-management/#word-of-advice","text":"Create a fresh mysql dump before following these steps Perform this operations outside of business hours On production environments enable maintenanace mode if possible On production environments disble the magento cron jobs till this activity is completed.","title":"Word of advice!"},{"location":"snippets/cloud-elasticsearch-management/#procedure","text":"","title":"Procedure"},{"location":"snippets/cloud-elasticsearch-management/#list-indices","text":"List the indices on the elasticsearch instance curl -s -X GET localhost:9200/_cat/indices?v This should give something lie this: health status index uuid pri rep docs.count docs.deleted store.size pri.store.size green open magento2_stg_product_16_v3 ro_35-TIQ5KT9H4ggVOwZw 3 2 0 0 2kb 705b green open magento2_stg_product_20_v94 MPZqxSLQQweP_YwjuIeTWg 3 2 19 4 955.9kb 318.6kb green open magento2_stg_product_18_v208 X7FehtL5RROo_crbnHYCxw 3 2 19 0 504.1kb 168kb green open magento2_stg_product_17_v4 lb-6wI_PTr-9hKVWWIQYjA 3 2 0 0 2kb 693b green open magento2_stg_product_6_v109 5ibsu0JmT9uOAS98bDS3Tg 3 2 61 0 201.3kb 64.6kb green open magento2_stg_product_1_v3552 fWMK8iSzRjeub_z58sT5gg 3 2 552 11 25.8mb 8.4mb green open magento2_stg_product_15_v125 HwztB4diTH2fQRGWwKS14A 3 2 21 3 1.6mb 547.8kb green open magento2_stg_product_9_v179 paVM9hHvT32ZG9jDNipNRg 3 2 0 0 1.8kb 624b green open magento2_stg_product_14_v498 _W2lSyEsQdWChM6kMro6Xw 3 2 21 0 1.1mb 398.2kb green open magento2_stg_product_5_v1094 2QfuKR42Q8q73oIsCJmNow 3 2 447 0 16.4mb 5.2mb green open magento2_product_1_v1 3irjvym7T5ycPgeQV0pOcg 3 2 0 0 2.2kb 783b","title":"List Indices"},{"location":"snippets/cloud-elasticsearch-management/#delete-indices","text":"curl - XDELETE localhost : 9200 /[ your_index_name_here ] Then do a full reindexing.","title":"Delete Indices"},{"location":"snippets/cloud-elasticsearch-management/#source","text":"https://support.magento.com/hc/en-us/articles/360039837952-Elasticsearch-Index-Status-is-yellow-or-red- https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/troubleshooting/elasticsearch/elasticsearch-index-status-is-yellow-or-red.html?lang=en","title":"Source:"},{"location":"snippets/cloud-rabbitmq-management/","text":"RabbitMQ Management \u2693\ufe0e To get the RabbitMQ connection credentials, Refer: URL: https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/configure/service/services-yaml.html?lang=en or execute below comand echo $MAGENTO_CLOUD_RELATIONSHIPS | base64 -d | json_pp Which will provide you mething like: \"rabbitmq\" : [ { \"username\" : \"mcloudprojectID_stg2\", \"vhost\" : \"mcloudprojectID_stg2\", \"port\" : \"5672\", \"host\" : \"localhost\", \"scheme\" : \"amqp\", \"password\" : \"Password_of_your_RabbitMQ\" } ], On non-magento-cloud instances use: grep amqp -A 7 app/etc/env.php Set Variables \u2693\ufe0e Set the path of your magrnto env.php file. export ENVFILE = app / etc / env . php Set the below variables for RabbitMQ conectivity. export RABBITHOST =$ ( grep amqp - A 7 $ { ENVFILE } | grep host | head - n1 | sed \"s/.*[=][>][ ]*[']//\" | sed \"s/['][,]//\" ); export RABBITUSER =$ ( grep amqp - A 7 $ { ENVFILE } | grep user | head - n1 | sed \"s/.*[=][>][ ]*[']//\" | sed \"s/['][,]//\" ); export RABBITPASS =$ ( grep amqp - A 7 $ { ENVFILE } | grep password | head - n1 | sed \"s/.*[=][>][ ]*[']//\" | sed \"s/['][,]//\" ); Connect to RabbitMQ in MCloud \u2693\ufe0e List Exchanges \u2693\ufe0e rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } list exchanges List Vhosts \u2693\ufe0e rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } list vhosts List Queues \u2693\ufe0e rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } list queues List Bindings \u2693\ufe0e rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } list bindings Additional Info. \u2693\ufe0e In the above senario, the admin port is running on TCP port 80/HTTP. But if in your case the rabbitMQ admin port is running on TCP port 443/HTTPS then add below option: --port 443 --ssl for ex: rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } --port 443 --ssl list queues","title":"Magento Cloud RabbitMQ"},{"location":"snippets/cloud-rabbitmq-management/#rabbitmq-management","text":"To get the RabbitMQ connection credentials, Refer: URL: https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/configure/service/services-yaml.html?lang=en or execute below comand echo $MAGENTO_CLOUD_RELATIONSHIPS | base64 -d | json_pp Which will provide you mething like: \"rabbitmq\" : [ { \"username\" : \"mcloudprojectID_stg2\", \"vhost\" : \"mcloudprojectID_stg2\", \"port\" : \"5672\", \"host\" : \"localhost\", \"scheme\" : \"amqp\", \"password\" : \"Password_of_your_RabbitMQ\" } ], On non-magento-cloud instances use: grep amqp -A 7 app/etc/env.php","title":"RabbitMQ Management"},{"location":"snippets/cloud-rabbitmq-management/#set-variables","text":"Set the path of your magrnto env.php file. export ENVFILE = app / etc / env . php Set the below variables for RabbitMQ conectivity. export RABBITHOST =$ ( grep amqp - A 7 $ { ENVFILE } | grep host | head - n1 | sed \"s/.*[=][>][ ]*[']//\" | sed \"s/['][,]//\" ); export RABBITUSER =$ ( grep amqp - A 7 $ { ENVFILE } | grep user | head - n1 | sed \"s/.*[=][>][ ]*[']//\" | sed \"s/['][,]//\" ); export RABBITPASS =$ ( grep amqp - A 7 $ { ENVFILE } | grep password | head - n1 | sed \"s/.*[=][>][ ]*[']//\" | sed \"s/['][,]//\" );","title":"Set Variables"},{"location":"snippets/cloud-rabbitmq-management/#connect-to-rabbitmq-in-mcloud","text":"","title":"Connect to RabbitMQ in MCloud"},{"location":"snippets/cloud-rabbitmq-management/#list-exchanges","text":"rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } list exchanges","title":"List Exchanges"},{"location":"snippets/cloud-rabbitmq-management/#list-vhosts","text":"rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } list vhosts","title":"List Vhosts"},{"location":"snippets/cloud-rabbitmq-management/#list-queues","text":"rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } list queues","title":"List Queues"},{"location":"snippets/cloud-rabbitmq-management/#list-bindings","text":"rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } list bindings","title":"List Bindings"},{"location":"snippets/cloud-rabbitmq-management/#additional-info","text":"In the above senario, the admin port is running on TCP port 80/HTTP. But if in your case the rabbitMQ admin port is running on TCP port 443/HTTPS then add below option: --port 443 --ssl for ex: rabbitmqadmin -u ${ RABBITUSER } -p ${ RABBITPASS } -H ${ RABBITHOST } --port 443 --ssl list queues","title":"Additional Info."},{"location":"snippets/magento-indexing/","text":"Magento Indexing \u2693\ufe0e Indexing is how Magento transforms data such as products and categories, to improve the performance of your storefront. As data changes, the transformed data must be updated or reindexed. To optimize storefront performance, Magento accumulates data into special tables using indexers. For example, if you change the price of an item from 4.99 to 3.99. Magento must reindex the price change to display it on your storefront. View a list of indexers \u2693\ufe0e To view a list of all indexers: bin/magento indexer:info The list displays as follows: design_config_grid Design Config Grid customer_grid Customer Grid catalog_category_product Category Products catalog_product_category Product Categories catalogrule_rule Catalog Rule Product catalog_product_attribute Product EAV inventory Inventory catalogrule_product Catalog Product Rule cataloginventory_stock Stock catalog_product_price Product Price catalogsearch_fulltext Catalog Search View indexer status \u2693\ufe0e Use this command to view the status of all indexers or specific indexers. For example, find out if an indexer needs to be reindexed. bin / magento indexer : status [ indexer ] To list status of all indexers: bin/magento indexer:status To Reindex \u2693\ufe0e Use this command to reindex all or selected indexers one time only. bin / magento indexer : reindex [ indexer ] To reindex all indexers: bin/magento indexer:reindex To use multiple threads for indexing use: MAGE_INDEXER_THREADS_COUNT=16 php -dmemory_limit=8G bin/magento indexer:reindex Reset indexer \u2693\ufe0e Use this command to invalidate the status of all indexers or specific indexers. bin / magento indexer : reset [ indexer ] To invalidate all indexers. bin/magento indexer:reset References \u2693\ufe0e https://devdocs.magento.com/guides/v2.3/extension-dev-guide/indexing.html https://devdocs.magento.com/guides/v2.3/config-guide/cli/config-cli-subcommands-index.html","title":"Magento Indexing"},{"location":"snippets/magento-indexing/#magento-indexing","text":"Indexing is how Magento transforms data such as products and categories, to improve the performance of your storefront. As data changes, the transformed data must be updated or reindexed. To optimize storefront performance, Magento accumulates data into special tables using indexers. For example, if you change the price of an item from 4.99 to 3.99. Magento must reindex the price change to display it on your storefront.","title":"Magento Indexing"},{"location":"snippets/magento-indexing/#view-a-list-of-indexers","text":"To view a list of all indexers: bin/magento indexer:info The list displays as follows: design_config_grid Design Config Grid customer_grid Customer Grid catalog_category_product Category Products catalog_product_category Product Categories catalogrule_rule Catalog Rule Product catalog_product_attribute Product EAV inventory Inventory catalogrule_product Catalog Product Rule cataloginventory_stock Stock catalog_product_price Product Price catalogsearch_fulltext Catalog Search","title":"View a list of indexers"},{"location":"snippets/magento-indexing/#view-indexer-status","text":"Use this command to view the status of all indexers or specific indexers. For example, find out if an indexer needs to be reindexed. bin / magento indexer : status [ indexer ] To list status of all indexers: bin/magento indexer:status","title":"View indexer status"},{"location":"snippets/magento-indexing/#to-reindex","text":"Use this command to reindex all or selected indexers one time only. bin / magento indexer : reindex [ indexer ] To reindex all indexers: bin/magento indexer:reindex To use multiple threads for indexing use: MAGE_INDEXER_THREADS_COUNT=16 php -dmemory_limit=8G bin/magento indexer:reindex","title":"To Reindex"},{"location":"snippets/magento-indexing/#reset-indexer","text":"Use this command to invalidate the status of all indexers or specific indexers. bin / magento indexer : reset [ indexer ] To invalidate all indexers. bin/magento indexer:reset","title":"Reset indexer"},{"location":"snippets/magento-indexing/#references","text":"https://devdocs.magento.com/guides/v2.3/extension-dev-guide/indexing.html https://devdocs.magento.com/guides/v2.3/config-guide/cli/config-cli-subcommands-index.html","title":"References"}]}